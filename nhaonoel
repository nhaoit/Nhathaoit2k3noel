<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Noel Photo Video</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
    margin:0;
    padding:0;
    background:#000;
    color:#fff;
    font-family:Arial,Helvetica,sans-serif;
    overflow:hidden;
}

/* ===== PREVIEW ===== */
#preview{
    position:absolute;
    top:0;
    left:0;
    right:0;
    bottom:120px;
    display:flex;
    align-items:center;
    justify-content:center;
}

#preview img{
    max-width:90%;
    max-height:90%;
    box-shadow:0 0 40px rgba(255,215,100,.8);
    border-radius:12px;
}

/* ===== TIMELINE ===== */
#timeline{
    position:fixed;
    left:0;
    right:0;
    bottom:0;
    height:120px;
    background:rgba(0,0,0,.8);
    backdrop-filter:blur(10px);
    display:flex;
    flex-direction:column;
}

#controls{
    padding:6px 10px;
}

#upload{
    display:inline-block;
    background:#ffd966;
    color:#000;
    padding:6px 14px;
    font-size:13px;
    border-radius:6px;
    cursor:pointer;
}
#fileInput{display:none}

/* strip giống video */
#strip{
    flex:1;
    display:flex;
    align-items:center;
    gap:8px;
    overflow-x:auto;
    padding:8px;
}

.frame{
    width:90px;
    height:60px;
    flex:none;
    border:2px solid transparent;
    cursor:pointer;
    border-radius:6px;
    overflow:hidden;
}
.frame img{
    width:100%;
    height:100%;
    object-fit:cover;
}
.frame.active{
    border-color:#ffd966;
}

/* ===== SNOW ===== */
canvas{
    position:absolute;
    inset:0;
    pointer-events:none;
}
</style>
</head>

<body>

<div id="preview">
    <img id="previewImg">
</div>

<canvas id="snow"></canvas>

<div id="timeline">
    <div id="controls">
        <label id="upload">
            Thêm ảnh
            <input id="fileInput" type="file" accept="image/*" multiple>
        </label>
    </div>
    <div id="strip"></div>
</div>

<script>
const previewImg=document.getElementById("previewImg");
const strip=document.getElementById("strip");
const fileInput=document.getElementById("fileInput");

let images=[];
let current=0;

/* ===== UPLOAD ===== */
fileInput.onchange=e=>{
    [...e.target.files].forEach((file,i)=>{
        const url=URL.createObjectURL(file);
        images.push(url);

        const div=document.createElement("div");
        div.className="frame";
        const img=document.createElement("img");
        img.src=url;
        div.appendChild(img);
        strip.appendChild(div);

        div.onclick=()=>{
            selectImage(images.indexOf(url));
        };

        if(images.length===1) selectImage(0);
    });
};

/* ===== SELECT ===== */
function selectImage(i){
    current=i;
    previewImg.src=images[i];
    document.querySelectorAll(".frame").forEach((f,idx)=>{
        f.classList.toggle("active",idx===i);
    });
}

/* ===== AUTO PLAY (giống video) ===== */
setInterval(()=>{
    if(images.length>1){
        current=(current+1)%images.length;
        selectImage(current);
    }
},3000);

/* ===== SNOW EFFECT ===== */
const canvas=document.getElementById("snow");
const ctx=canvas.getContext("2d");
let w,h;
function resize(){
    w=canvas.width=innerWidth;
    h=canvas.height=innerHeight;
}
resize();
window.onresize=resize;

const snow=[];
for(let i=0;i<200;i++){
    snow.push({
        x:Math.random()*w,
        y:Math.random()*h,
        r:Math.random()*3+1,
        s:Math.random()*1+0.5
    });
}

function drawSnow(){
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle="white";
    snow.forEach(p=>{
        p.y+=p.s;
        if(p.y>h) p.y=0;
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
        ctx.fill();
    });
    requestAnimationFrame(drawSnow);
}
drawSnow();
</script>

</body>
</html>
